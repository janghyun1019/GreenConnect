<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="post_mapper">

	<insert id="savePostImages" parameterType="Image">
	INSERT INTO image
	(image_id, post_id, file_name, original_file_name, file_path, url_file_path, file_extension, uploaded_at)
	VALUES
	(images_id_seq.NEXTVAL, #{postId}, #{fileName}, #{originalFileName}, #{filePath}, #{urlFilePath},
	#{fileExtension}, #{uploadedAt})
	</insert>
	
	<insert id="savePost" parameterType="Post">
		INSERT INTO post (post_id, user_id, nick_name, board_id, post_product_type, post_title, post_content, post_sales_unit, post_price, post_spot, post_cost, store_id) 
	    VALUES (post_id_seq.NEXTVAL, #{userId}, #{nickName}, #{boardId}, #{postProductType}, #{postTitle}, #{postContent}, #{postSalesUnit}, #{postPrice}, #{postSpot},#{postCost}, #{storeId})
	</insert>

	<select id="getLastPostId" resultType="int">
		SELECT post_id_seq.CURRVAL FROM DUAL
	</select>
	
	<select id="getPostDetailsByPostId" parameterType="String"
		resultType="Post">
		SELECT * FROM post WHERE post_id = #{postId} order by post_id
	</select>
	
	<select id="getPostDetailsImageUrlsByPostId" parameterType="String"
		resultType="String">
		select url_file_path from image where post_id = #{postId} order by post_id
	</select>
	
	
	
	
	
	
	
	
</mapper>